let dragOffsetY=document.querySelector("#drag-container").offsetTop,dragOffsetX=document.querySelector("#drag-container").offsetLeft,gameOffsetX=document.querySelector("#game").offsetLeft,gameOffsetY=document.querySelector("#game").offsetTop,currentLevel=0,player="";function getPlayerNameFromLocal(){localStorage.name&&(document.querySelector("#player-nickname-input").value=localStorage.name)}document.addEventListener("keypress",function(a){"Enter"===a.key&&document.querySelector(".btn-play")&&document.querySelector(".btn-play").click()});async function createPlayer(){let a=document.querySelector(".btn-play"),b=document.querySelector("#player-nickname-input"),c="";return await fetch(`./api/validate/${b.value}`).then(a=>a.json()).catch(()=>b.classList.add("empty-input")).then(a=>c=a),c?void(b.classList.remove("empty-input"),nameAddedAnimation(),a.setAttribute("onclick",""),await Api.userRequest("get",c).then(b=>{b?(player=new Player(c,b.gamesRemaining||[],b.gamesFinished),0===player.gamesRemaining.length?a.setAttribute("onclick","removeCharacterInterface(\"new\")"):a.setAttribute("onclick","removeCharacterInterface(\"next\")")):(player=new Player(c),a.setAttribute("onclick","removeCharacterInterface(\"new\")"))}),localStorage.setItem("name",c)):b.classList.add("empty-input")}let levelTimer="";function gameInitialize(a){levelTimer&&levelTimer.stopTimer(),DragElements.stopDrag(),"new"===a?(player=new Player(player.name),levelTimer=new timer,currentLevel="1",levelTimer.startTimer()):"next"==a&&(currentLevel=player.gamesRemaining[LevelSelector.nextLevel()],levelTimer=new timer,levelTimer.startTimer()),Api.getLevelValidationSet(currentLevel).then(a=>player.setCurrentLevelValidationSet(a)),document.querySelector(".leaderboard.player").innerHTML="",document.querySelector(".btn-name").innerText=player.name,0===player.gamesFinished.length?document.querySelector(".btn-level").innerText="Tutorial":document.querySelector(".btn-level").innerHTML=`Puzzle <span>${player.gamesFinished.length}</span>`;try{new ResizeObserver(()=>document.querySelector("#drag-container").style.width=document.querySelector("#game").clientWidth+"px").observe(document.querySelector("#game"))}catch(a){document.querySelector("#drag-container").style.width="600px",console.log("ResizeObserver not available")}document.querySelector("#game").innerHTML=`<img src="./resources/levels/level${currentLevel}.svg" id="level" onload="SVGInject(this)"></img>`,resetOffsets(),newLevelAnimations(),getLevelLeaderboard(currentLevel),DragElements.startDrag()}function resetOffsets(){dragOffsetY=document.querySelector("#drag-container").offsetTop,dragOffsetX=document.querySelector("#drag-container").offsetLeft,gameOffsetX=document.querySelector("#game").offsetLeft,gameOffsetY=document.querySelector("#game").offsetTop}let windowWidth=window.innerWidth;window.onresize=()=>{this.innerWidth===windowWidth||(windowWidth=this.innerWidth,resetOffsets(),resetPieces())};class Api{static async userRequest(a,b,c){return await fetch(`./api/users/${b}`,{method:a,headers:{"Content-type":"application/json"},body:c}).then(a=>a.json())}static async leaderboardRequest(a,b,c,d){return c||(c=""),await fetch(`./api/leaderboard/${b}/${c}`,{method:a,headers:{"Content-type":"application/json"},body:d}).then(a=>a.json())}static async avgLeaderboardRequest(){return await fetch(`./api/avgLeaderboard/`).then(a=>a.json())}static async getLevelValidationSet(a){return await fetch(`./api/levelvalidationset/${a}`).then(a=>a.json())}static getLevelKeysArr(){return fetch("./api/levelkeysarray").then(a=>a.json())}}function getLevelLeaderboard(a){Api.leaderboardRequest("get",a).then(b=>{drawLeaderboard(b,a)})}function getAverageLeaderboard(){Api.avgLeaderboardRequest().then(a=>{drawLeaderboard(a)})}function drawLeaderboard(a,b){if(1==b)return;let c,d=document.querySelector(".leaderboard"),e=document.querySelector("#leaderboard-title-text"),f="";b?(c=document.querySelector(".btn-level span").innerText,e.innerText=`PUZZLE ${c} LEADERBOARD`):(e.innerText=`AVERAGE TIMES LEADERBOARD`,b=""),a.length||(f=`
      <li class="leaderboard-entry d-flex justify-content-center">
        <p class="leaderboard-text opacity20">No one finished this level yet</p>
      </li>
    `);for(let c=0;c<a.length;c++)f+=a[c][0]===player.name?`
        <li class="leaderboard-entry d-flex">
          <i class="fas fa-star d-flex align-self-center"></i>
          <div class="w-100 d-flex justify-content-between">
            <p class="leaderboard-text text-start">${c+1}</p>
            <p class="leaderboard-text text-center">${a[c][0]}</p>
            <p class="leaderboard-text text-end">${leaderboardSecondsToMinutes(a[c][1],b)}</p>
          </div>
        </li>
      `:`
        <li class="leaderboard-entry d-flex justify-content-between">
          <p class="leaderboard-text text-start">${c+1}</p>
          <p class="leaderboard-text text-center">${a[c][0]}</p>
          <p class="leaderboard-text text-end">${leaderboardSecondsToMinutes(a[c][1],b)}</p>
        </li>
      `;d.innerHTML=f;let g=document.querySelectorAll(".leaderboard .leaderboard-entry");g[0]?g[0].classList.add("first"):"",g[1]?g[1].classList.add("second"):"",g[2]?g[2].classList.add("third"):""}function leaderboardSecondsToMinutes(a,b){function c(a){return a.split(".").join("<span>s</span> ")+"<span>ms</span>"}let d=parseInt(a/60),e=a%60;return b?10>e?`${d}<span>m</span> 0${e}<span>s</span>`:`${d}<span>m</span> ${e}<span>s</span>`:10>e?`${d}<span>m</span> 0${c(e.toFixed(2))}`:`${d}<span>m</span> ${c(e.toFixed(2))}`}let Origins={referenceCoordinates:[{top:-13,left:0,transform:"rotate(0deg)"},{top:84,left:115,transform:"rotate(90deg)"},{top:200,left:-5,transform:"rotate(0deg)"},{top:90,left:-90,transform:"rotate(90deg)"},{top:279,left:191,transform:"rotate(0deg)"},{top:131,left:46,transform:"rotate(90deg)"},{top:202,left:103,transform:"rotate(0deg)"}],stroke:document.querySelector("#stroke"),pieceOriginalCoords:[{top:-13,left:0,transform:"rotate(0deg)"},{top:84,left:115,transform:"rotate(90deg)"},{top:200,left:-5,transform:"rotate(0deg)"},{top:90,left:-90,transform:"rotate(90deg)"},{top:279,left:191,transform:"rotate(0deg)"},{top:131,left:46,transform:"rotate(90deg)"},{top:202,left:103,transform:"rotate(0deg)"}],originsRecalculation:function(){if(1365>window.innerWidth)for(let a=0;a<this.referenceCoordinates.length;a++)this.pieceOriginalCoords[a].left=this.referenceCoordinates[a].left+window.innerWidth/2-180;else for(let a=0;a<this.referenceCoordinates.length;a++)this.pieceOriginalCoords[a].left=this.referenceCoordinates[a].left+window.innerWidth/2+80}},rotatePieces=a=>{a.preventDefault();let b=["rotate(0deg)","rotate(45deg)","rotate(90deg)","rotate(135deg)","rotate(180deg)","rotate(225deg)","rotate(270deg)","rotate(315deg)"];if(a.target.closest(".piece"))if(a.target.closest(".piece").firstElementChild.classList.contains("in-place"))return;else{"square"===a.target.closest(".piece").firstElementChild.id?b=["rotate(0deg)","rotate(45deg)"]:"para"===a.target.closest(".piece").firstElementChild.id&&(b=["rotate(0deg)","rotate(45deg)","rotate(90deg)","rotate(135deg)"]);let c=a.target.closest(".piece").style;c.transform=b.indexOf(c.transform)===b.length-1?b[0]:b[b.indexOf(c.transform)+1],validateMove(a.target.closest(".piece"))}};/Mobi/.test(navigator.userAgent)?document.querySelector(".game-container").ondblclick=rotatePieces:document.querySelector(".game-container").oncontextmenu=rotatePieces;let DragElements={pieces:document.querySelectorAll(".piece"),manipulatePieces:[],startDrag:function(){for(let a,b=0;b<this.pieces.length;b++)a={onMouseDown:()=>{this.pieces[b].style.zIndex=2},onMouseUp:()=>{validateMove(this.pieces[b])},onTouchMove:()=>{this.pieces[b].style.zIndex=2},onTouchStop:()=>{validateMove(this.pieces[b])}},this.manipulatePieces.push(window.displacejs(this.pieces[b],a))},stopDrag:function(){for(let a=0;a<this.manipulatePieces.length;a++)this.manipulatePieces[a].destroy()}},defaultsRemainingKeys=[];(()=>{Api.getLevelKeysArr().then(a=>defaultsRemainingKeys=a)})();class Player{constructor(a,b,c){this.defaults={remaining:defaultsRemainingKeys,finished:[]},this.name=a,this.currentLevelValidationSet={},this.gamesRemaining=b||[...this.defaults.remaining],this.gamesFinished=c||[...this.defaults.finished]}setCurrentLevelValidationSet(a){this.currentLevelValidationSet=JSON.parse(JSON.stringify(a))}levelComplete(a){let b=this.gamesRemaining.indexOf(a),c=levelTimer.stopTimer();return this.gamesRemaining.splice(b,1),this.gamesFinished.push({level:a,timeScore:c}),c}resetGame(){this.gamesRemaining=[...this.defaults.remaining],this.gamesFinished=[...this.defaults.finished]}}let LevelSelector={newGame:function(){return player.resetGame(),this.currentLevel=Math.floor(Math.random()*player.gamesRemaining.length),this.currentLevel},nextLevel:function(){for(let a=0;a<player.gamesFinished.length;a++)if(0!==player.gamesFinished.length)return this.currentLevel=Math.floor(Math.random()*player.gamesRemaining.length),this.currentLevel}};function timer(){function a(a){let b=parseInt(a/60),c=a%60;f.innerText=10>c?`${b}:0${c}`:`${b}:${c}`}let b=1e3,c=0,d=Date.now()+1000,e="",f=document.querySelector("#timer");this.startTimer=function(){function f(){var g=Date.now()-d;g>b,c++,a(c),d+=b,e=setTimeout(f,Math.max(0,b-g))}e=setTimeout(f,b)},this.stopTimer=function(){return clearTimeout(e),c}}function validateMove(a){let b=25,c="";c="big-"===a.firstElementChild.id?"big-t":"small-"===a.firstElementChild.id?"small-t":a.firstElementChild.id;let d=player.currentLevelValidationSet[c];for(let e=0;e<d.length;e++){let f=d[e].top+gameOffsetY,g=parseInt(a.style.top),h=d[e].left+gameOffsetX,i=parseInt(a.style.left);f+b>g&&h+b>i&&f-b<g&&h-b<i&&a.style.transform===d[e].transform&&(setTimeout(()=>{a.style.top=f+"px",a.style.left=h+"px",inPlacePositions[a.firstElementChild.id]={top:f-gameOffsetY,left:h-gameOffsetX}},30),1===d.length?delete player.currentLevelValidationSet[c]:d.splice(e,1),a.style.zIndex=0,a.firstElementChild.classList.add("in-place"),!Object.keys(player.currentLevelValidationSet).length&&validateGame())}}function validateGame(){setTimeout(async()=>{DragElements.stopDrag();player.levelComplete(currentLevel);if(1!==parseInt(currentLevel)){let a=0,b=0,c={gamesRemaining:player.gamesRemaining,gamesFinished:player.gamesFinished};await Api.userRequest("put",player.name,JSON.stringify(c)).then(a=>{GameFinished.setAvgTime(a[1].avgTime),b=a[2]}),Api.leaderboardRequest("get",currentLevel,player.name).then(b=>{a=b}).then(()=>{10<b?document.querySelector(".leaderboard.player").innerHTML=`
									<li class="leaderboard-entry d-flex">
										<i class="fas fa-star d-flex align-self-center"></i>
										<div class="w-100 d-flex justify-content-between">
											<p class="leaderboard-text">${b}</p>
											<p class="leaderboard-text">${player.name}</p>
											<p class="leaderboard-text">${leaderboardSecondsToMinutes(a)}</p>
										</div>
									</li>
								`:getLevelLeaderboard(currentLevel)})}levelFinishedAnimations(),player.gamesRemaining.length||GameFinished.createModal()},60)}(function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.displacejs=b():a.displacejs=b()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){'use strict';var d=c(1),e=function(a){return a&&a.__esModule?a:{default:a}}(d);a.exports=e.default},function(a,b,c){'use strict';function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){var a=this,b=this.el,c=this.opts||i,d={};if(b.style.position="absolute",this.handle=c.handle||b,c.constrain){for(var e=c.relativeTo||b.parentNode,j=b,k=0,l=0;j!==e;)j=j.parentNode,(0,f.isRelative)(j)&&(k-=j.offsetLeft,l-=j.offsetTop),j===e&&(k+=j.offsetLeft,l+=j.offsetTop);var m=k+e.offsetWidth-b.offsetWidth,n=l+e.offsetHeight-b.offsetHeight;d.xClamp=(0,f.generateClamp)(k,m),d.yClamp=(0,f.generateClamp)(l,n)}this.opts=c,this.data=d,this.events={mousedown:g.mousedown.bind(this),mouseup:g.mouseup.bind(this),touchstart:g.touchstart.bind(this),touchstop:g.touchstop.bind(this),scrollFix:function(b){a.isDragging&&b.preventDefault()}},this.handleMove=h(this.opts.customMove),this.handle.addEventListener("mousedown",this.events.mousedown,!1),this.handle.addEventListener("touchstart",this.events.touchstart,!1),document.addEventListener("touchmove",this.events.scrollFix,{passive:!1})}Object.defineProperty(b,"__esModule",{value:!0});var f=c(2),g=c(3),h=(0,f.generateMoveFn)(),i={constrain:!1,relativeTo:null,handle:null,highlightInputs:!1,onMouseDown:null,onMouseMove:null,onMouseUp:null,onTouchStart:null,onTouchMove:null,onTouchStop:null,customMove:null},j=function(){function a(b,c){if(d(this,a),!b)throw Error("Must include moveable element");this.el=b,this.opts=c,e.call(this)}return a.prototype.reinit=function(){this.destroy(),e.call(this)},a.prototype.destroy=function(){var a=this.events;this.handle.removeEventListener("mousedown",a.mousedown,!1),document.removeEventListener("mousemove",a.mousemove,!1),document.removeEventListener("mouseup",a.mouseup,!1),this.handle.removeEventListener("touchstart",a.touchstart,!1),document.removeEventListener("touchmove",a.touchmove,!1),document.removeEventListener("touchstop",a.touchstop,!1),document.removeEventListener("touchmove",this.events.scrollFix,{passive:!1})},a}();b.default=function(a,b){return new j(a,b)}},function(a,b){'use strict';function c(a,b,c){a.style.left=b+"px",a.style.top=c+"px"}Object.defineProperty(b,"__esModule",{value:!0}),b.generateClamp=function(a,b){return function(c){return Math.min(Math.max(c,a),b)}},b.isRelative=function(a){return"relative"===window.getComputedStyle(a).position},b.generateMoveFn=function(){return window.requestAnimationFrame?function(a){return function(b,d,e){window.requestAnimationFrame(function(){(a||c)(b,d,e)})}}:function(a){return function(b,d,e){(a||c)(b,d,e)}}}},function(a,b){'use strict';function c(a,b,c){var d=this.el,e=this.opts,f=this.data;"function"==typeof e.onMouseMove&&e.onMouseMove(d,c);var g=c.clientX-a,h=c.clientY-b;return e.constrain&&(g=f.xClamp(g),h=f.yClamp(h)),this.handleMove(d,g,h),c.preventDefault(),!1}function d(a,b,c){var d=this.el,e=this.opts,f=this.data;"function"==typeof e.onTouchMove&&e.onTouchMove(d,c);var g=c.targetTouches[0],h=g.clientX-a,i=g.clientY-b;return e.constrain&&(h=f.xClamp(h),i=f.yClamp(i)),this.handleMove(d,h,i),c.preventDefault(),!1}Object.defineProperty(b,"__esModule",{value:!0}),b.mousedown=function(a){var b=this.opts;if(b.highlightInputs){var d=a.target.tagName.toLowerCase();if("input"===d||"textarea"===d)return}var e=this.el,f=this.events;if("function"==typeof b.onMouseDown&&b.onMouseDown(e,a),a&&0===a.button){var g=a.clientX-e.offsetLeft,h=a.clientY-e.offsetTop;f.mousemove=c.bind(this,g,h),document.addEventListener("mousemove",f.mousemove,!1),document.addEventListener("mouseup",f.mouseup,!1)}},b.mousemove=c,b.mouseup=function(a){var b=this.el,c=this.opts,d=this.events;"function"==typeof c.onMouseUp&&c.onMouseUp(b,a),document.removeEventListener("mouseup",d.mouseup,!1),document.removeEventListener("mousemove",d.mousemove,!1),document.removeEventListener("mousedown",d.mousedown,!1)},b.touchstart=function(a){var b=this.opts;if(b.highlightInputs){var c=a.target.tagName.toLowerCase();if("input"===c||"textarea"===c)return}var e=this.el,f=this.events;"function"==typeof b.onTouchStart&&b.onTouchStart(e,a);var g=a.targetTouches[0],h=g.clientX-e.offsetLeft,i=g.clientY-e.offsetTop;f.touchmove=d.bind(this,h,i),this.isDragging=!0,document.addEventListener("touchmove",f.touchmove,!1),document.addEventListener("touchend",f.touchstop,!1),document.addEventListener("touchcancel",f.touchstop,!1)},b.touchmove=d,b.touchstop=function(a){this.isDragging=!1;var b=this.el,c=this.opts,d=this.events;"function"==typeof c.onTouchStop&&c.onTouchStop(b,a),document.removeEventListener("touchmove",d.touchmove,!1),document.removeEventListener("touchend",d.touchstop,!1),document.removeEventListener("touchcancel",d.touchstop,!1)}}])});!function(b,c){function d(a){return(i=i||new XMLSerializer).serializeToString(a)}function g(b,e){var g,j,k,q,w="--inject-"+x++,a=/url\("?#([a-zA-Z][\w:.-]*)"?\)/g,r=b.querySelectorAll("[id]"),u=e?[]:C,c={},l=[],s=!1;if(r.length){for(k=0;k<r.length;k++)(j=r[k].localName)in f&&(c[j]=1);for(j in c)(f[j]||[j]).forEach(function(a){0>l.indexOf(a)&&l.push(a)});l.length&&l.push("style");var z,A,B,D=b.getElementsByTagName("*"),h=b;for(k=-1;h!=C;){if(h.localName=="style")(B=(A=h.textContent)&&A.replace(a,function(a,b){return u&&(u[b]=1),"url(#"+b+w+")"}))!==A&&(h.textContent=B);else if(h.hasAttributes()){for(q=0;q<l.length;q++)z=l[q],(B=(A=h.getAttribute(z))&&A.replace(a,function(a,b){return u&&(u[b]=1),"url(#"+b+w+")"}))!==A&&h.setAttribute(z,B);["xlink:href","href"].forEach(function(a){var b=h.getAttribute(a);/^\s*#/.test(b)&&(b=b.trim(),h.setAttribute(a,b+w),u&&(u[b.substring(1)]=1))})}h=D[++k]}for(k=0;k<r.length;k++)g=r[k],u&&!u[g.id]||(g.id+=w,s=!0)}return s}function h(b,d,e,g){if(d){d.setAttribute("data-inject-url",e);var h=b.parentNode;if(h){g.copyAttributes&&function(b,d){for(var e,g,h,j=b.attributes,k=0;k<j.length;k++)if(g=(e=j[k]).name,-1==s.indexOf(g))if(h=e.value,g=="title"){var l,m=d.firstElementChild;m&&m.localName.toLowerCase()=="title"?l=m:(l=c.createElementNS("http://www.w3.org/2000/svg","title"),d.insertBefore(l,m)),l.textContent=h}else d.setAttribute(g,h)}(b,d);var i=g.beforeInject,j=i&&i(b,d)||d;h.replaceChild(j,b),b.__svgInject=1,l(b);var a=g.afterInject;a&&a(b,j)}}else y(b,g)}function k(){for(var a,b={},c=arguments,d=0;d<c.length;d++)for(var e in a=c[d],a)a.hasOwnProperty(e)&&(b[e]=a[e]);return b}function w(a,b){if(b){var d;try{d=function(a){return(o=o||new DOMParser).parseFromString(a,"text/xml")}(a)}catch(a){return C}return d.getElementsByTagName("parsererror").length?C:d.documentElement}var e=c.createElement("div");return e.innerHTML=a,e.firstElementChild}function l(a){a.removeAttribute("onload")}function m(a){console.error("SVGInject: "+a)}function n(a,b,c){a.__svgInject=2,c.onFail?c.onFail(a,b):m(b)}function y(a,b){l(a),n(a,"SVG_INVALID",b)}function z(a,b){l(a),n(a,"SVG_NOT_SUPPORTED",b)}function A(a,b){n(a,"LOAD_FAIL",b)}function B(a){a.onload=C,a.onerror=C}function q(){m("no img element")}var i,o,C=null,p=/--inject-\d+/g,s=["src","alt","onload","onerror"],t=c.createElement("a"),j=typeof SVGRect!="undefined",v={useCache:!0,copyAttributes:!0,makeIdsUnique:!0},f={clipPath:["clip-path"],"color-profile":C,cursor:C,filter:C,linearGradient:["fill","stroke"],marker:["marker","marker-end","marker-mid","marker-start"],mask:C,pattern:["fill","stroke"],radialGradient:["fill","stroke"]},x=1,u=function a(f,e){function i(b,a){a=k(n,a);var c=function(c){var d=function(){var b=a.onAllFinish;b&&b(),c&&c()};if(b&&typeof b.length!="undefined"){var e=0,f=b.length;if(0==f)d();else for(var g=function(){++e==f&&d()},h=0;h<f;h++)m(b[h],a,g)}else m(b,a,d)};return typeof Promise=="undefined"?c():new Promise(c)}function m(b,k,c){if(b){var e=b.__svgInject;if(e)Array.isArray(e)?e.push(c):c();else{if(B(b),!j)return z(b,k),void c();var f=k.beforeLoad,m=f&&f(b)||b.getAttribute("src");if(!m)return""===m&&A(b,k),void c();var n=[];b.__svgInject=n;var u=function(){c(),n.forEach(function(a){a()})},l=function(a){return t.href=a,t.href}(m),i=k.useCache,s=k.makeIdsUnique,v=function(a){i&&(D[l].forEach(function(b){b(a)}),D[l]=a)};if(i){var r,E=function(a){if(a==="LOAD_FAIL")A(b,k);else if(a==="SVG_INVALID")y(b,k);else{var c,e=a[0],f=a[1],j=a[2];s&&(e===C?(e=g(c=w(f,!1),!1),a[0]=e,a[2]=e&&d(c)):e&&(f=function(a){return a.replace(p,"--inject-"+x++)}(j))),c=c||w(f,!1),h(b,c,l,k)}u()};if(typeof(r=D[l])!="undefined")return void(r.isCallbackQueue?r.push(E):E(r));(r=[]).isCallbackQueue=!0,D[l]=r}!function(a,b,c){if(a){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState){var a=d.status;200==a?b(d.responseXML,d.responseText.trim()):400<=a?c():0==a&&c()}},d.open("GET",a,!0),d.send()}}(l,function(c,e){var j=c instanceof Document?c.documentElement:w(e,!0),m=k.afterLoad;if(m){var n=m(j,e)||j;if(n){var p="string"==typeof n;e=p?n:d(j),j=p?w(n,!0):n}}if(j instanceof SVGElement){var o=C;if(s&&(o=g(j,!1)),i){var q=o&&d(j);v([o,e,q])}h(b,j,l,k)}else y(b,k),v("SVG_INVALID");u()},function(){A(b,k),v("LOAD_FAIL"),u()})}}else q()}var n=k(v,e),D={};return j&&function(a){var b=c.getElementsByTagName("head")[0];if(b){var d=c.createElement("style");d.type="text/css",d.appendChild(c.createTextNode(a)),b.appendChild(d)}}("img[onload^=\""+f+"(\"]{visibility:hidden;}"),i.setOptions=function(a){n=k(n,a)},i.create=a,i.err=function(a,b){a?a.__svgInject!=2&&(B(a),j?(l(a),A(a,n)):z(a,n),b&&(l(a),a.src=b)):q()},b[f]=i}("SVGInject");"object"==typeof module&&"object"==typeof module.exports&&(module.exports=u)}(window,document);let GameFinished={avgTime:"",setAvgTime:a=>{GameFinished.avgTime=a},createModal:()=>{let a=document.createElement("div");a.setAttribute("id","game-finished-modal"),a.classList.add("d-flex","justify-content-center","align-items-center"),a.innerHTML=`
  
    <div class="modal-body d-flex flex-column align-items-center">
      
        <p>Congrats ${player.name}, You have finished all the puzzles</p>
        <p>Your average time per puzzle is: </p>
        <p> ${leaderboardSecondsToMinutes(GameFinished.avgTime)}</p>
        <p>Think you can do better?</p>
        <button class="btn" onclick="removeModal();removeLevelFinishedAnimations();gameInitialize('new')">New game</button>

    </div>
  `,document.querySelector("body").appendChild(a)}};function removeModal(){document.querySelector("#game-finished-modal").remove()}function levelFinishedAnimations(){let a=document.styleSheets[0],b=document.querySelector("#game"),c=document.querySelector("#drag-container"),d=document.querySelector("#next-level"),e=document.querySelector("#stroke"),f=document.querySelector(".timer-container"),g=window.innerWidth/2-document.querySelector("#game").offsetLeft-document.querySelector("#game").offsetWidth/2;skipButton.disappear(),a.insertRule(`@keyframes game-level-finished{
    0%{transform: translateX(0);}
    100%{transform: translateX(calc(${g}px));}
  }`,a.cssRules.length),c.classList.add("drag-container-level-finished"),c.addEventListener("animationend",()=>{b.classList.add("game-level-finished"),b.classList.add("game-level-finished-fill"),d.classList.add("next-button-level-finished"),e.classList.add("stroke-level-finished"),f.classList.add("timer-level-finished")},{once:!0}),b.addEventListener("animationend",()=>{e.style.opacity=0,d.setAttribute("onclick","gameInitialize('next');removeLevelFinishedAnimations();"),b.classList.remove("game-level-finished"),b.style.transform=`translateX(calc(${g}px))`},{once:!0})}function removeLevelFinishedAnimations(){let a=document.querySelector("#game"),b=document.querySelector("#drag-container"),c=document.querySelector("#next-level"),d=document.querySelector("#stroke"),e=document.querySelector(".timer-container");a.classList.remove("game-level-finished-fill"),b.classList.remove("drag-container-level-finished"),c.classList.remove("next-button-level-finished"),d.classList.remove("stroke-level-finished"),e.classList.remove("timer-level-finished"),a.style.transform=`translateX(0px)`,c.removeAttribute("onclick");let f=document.styleSheets[0];10<f.cssRules.length&&f.deleteRule(f.cssRules.length-1)}function newLevelAnimations(){let a=document.querySelector("#game"),b=document.querySelector("#stroke"),c=document.querySelectorAll(".piece"),d=document.querySelector(".timer-container");Origins.originsRecalculation(),skipButton.appear(),a.classList.add("game-appearing"),a.style.opacity=1,d.classList.add("timer-appearing"),d.style.opacity=1,b.classList.add("stroke-apearing"),b.style.opacity=1;for(let a=0;a<c.length;a++)c[a].style.top=Origins.pieceOriginalCoords[a].top+dragOffsetY+"px",c[a].style.left=Origins.pieceOriginalCoords[a].left+"px",c[a].style.transform=Origins.pieceOriginalCoords[a].transform,c[a].firstElementChild.classList.remove("in-place"),"rotate(90deg)"===c[a].style.transform?c[a].classList.add("svg-container-appearing-rotated"):c[a].classList.add("svg-container-appearing"),c[a].style.opacity=1;document.querySelector("#game").addEventListener("animationend",()=>{resetOffsets(),document.querySelector("#game").classList.remove("game-appearing"),document.querySelector("#stroke").classList.remove("stroke-apearing");for(let a=0;a<c.length;a++)"rotate(90deg)"===c[a].style.transform?c[a].classList.remove("svg-container-appearing-rotated"):c[a].classList.remove("svg-container-appearing");d.classList.remove("timer-appearing"),resetPieces()},{once:!0})}let skipButton={skipBtn:document.querySelector(".skip-level"),appear:()=>{"1"!==currentLevel&&(skipButton.skipBtn.classList.remove("skip-button-disappear"),skipButton.skipBtn.classList.add("skip-button-appear"))},disappear:()=>{skipButton.skipBtn.classList.remove("skip-button-appear"),skipButton.skipBtn.classList.add("skip-button-disappear")},handleClick:()=>{skipButton.skipBtn.classList.contains("resetTrue")?(gameInitialize("next"),skipButton.skipBtn.classList.remove("resetTrue"),skipButton.skipBtn.innerText="Skip Level"):(skipButton.skipBtn.innerText="Confirm",skipButton.skipBtn.classList.add("resetTrue"),setTimeout(()=>{skipButton.skipBtn.classList.remove("resetTrue"),skipButton.skipBtn.innerText="Skip Level"},2e3))}};function nameAddedAnimation(){let a=document.querySelector("#player-nickname-input"),b=document.querySelectorAll(".game-tutorial");document.querySelector(".player-input-container").classList.add("player-input-container-name-added"),document.querySelector(".player-input-info").classList.add("player-input-info-remove"),a.style.pointerEvents="none";for(let a=0;a<b.length;a++)b[a].classList.add("game-tutorial-show");document.querySelector(".btn-play").classList.add("removeTrue")}function removeCharacterInterface(a){document.querySelector(".btn-play").classList.contains("removeTrue")&&(document.querySelector(".removable-container").classList.add("remove-new-player-interface"),document.querySelector(".title-container a").style.display="inline",document.querySelector(".removable-container").addEventListener("animationend",()=>{document.querySelector(".removable-container").remove(),document.querySelector(".nav").classList.add("navbar-appear"),gameInitialize(a)},{once:!0}))}function resetPieces(){let a=document.styleSheets[0],b=document.querySelectorAll(".piece"),c=document.querySelector(".reset-button");Origins.originsRecalculation(),c.setAttribute("onclick","");for(let d,e=0;e<b.length;e++)d=b[e].firstElementChild.id,b[e].firstElementChild.classList.contains("in-place")?a.insertRule(`@keyframes reset-${d}{
        0%{
          top: ${b[e].style.top}; 
          left:${b[e].style.left};  
        }
        100%{
          top: ${inPlacePositions[d].top+gameOffsetY}px; 
          left:${inPlacePositions[d].left+gameOffsetX}px;
        }
      }
      `,a.cssRules.length):a.insertRule(`@keyframes reset-${d}{
        0%{
          top: ${b[e].style.top}; 
          left:${b[e].style.left};  
          transform:${b[e].style.transform};
        }
        100%{
          top: ${Origins.pieceOriginalCoords[e].top+dragOffsetY}px; 
          left:${Origins.pieceOriginalCoords[e].left}px;
          transform:${Origins.pieceOriginalCoords[e].transform};
        }
      }
      `,a.cssRules.length),b[e].classList.add(`reset-${d}`),document.querySelector(`.reset-${d}`).addEventListener("animationend",()=>{c.setAttribute("onclick","resetPieces();"),b[e].firstElementChild.classList.contains("in-place")?(b[e].style.top=inPlacePositions[d].top+gameOffsetY+"px",b[e].style.left=inPlacePositions[d].left+gameOffsetX+"px"):(b[e].style.top=Origins.pieceOriginalCoords[e].top+dragOffsetY+"px",b[e].style.left=Origins.pieceOriginalCoords[e].left+"px",b[e].style.transform=Origins.pieceOriginalCoords[e].transform),b[e].classList.remove(`reset-${d}`),Object.keys(a.cssRules)[7]&&a.deleteRule(7)});resetOffsets()}let inPlacePositions={"big-t":{},"big-":{},medT:{},para:{},smallT1:{},smallT2:{}};